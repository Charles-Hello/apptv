# Bç«™æœç´¢åŠŸèƒ½é›†æˆæµ‹è¯•æ–‡æ¡£

## åŠŸèƒ½è¯´æ˜

å®ç°äº†ä»æ‰‹æœºé¥æ§å™¨ç•Œé¢æœç´¢ B ç«™å†…å®¹çš„åŠŸèƒ½ï¼Œæœç´¢ç»“æœåœ¨ macOS æµè§ˆå™¨å½“å‰é¡µé¢è·³è½¬æ˜¾ç¤ºã€‚

## æ¶æ„æµç¨‹

```
æ‰‹æœºæµè§ˆå™¨                                            macOSæµè§ˆå™¨
   â”‚                                                      â”‚
   â”œâ”€ 1. æ‰“å¼€Bç«™æ¨¡å¼å¼€å…³                                   â”‚
   â”œâ”€ 2. æ˜¾ç¤ºæœç´¢è¾“å…¥æ¡†                                    â”‚
   â”œâ”€ 3. è¾“å…¥æœç´¢å…³é”®è¯                                    â”‚
   â”œâ”€ 4. ç‚¹å‡»æœç´¢æŒ‰é’®                                      â”‚
   â”‚                                                      â”‚
   â†“                                                      â”‚
WebSocket â†’ Server (Flask)                               â”‚
              â”‚                                           â”‚
              â”œâ”€ 5. æ¥æ”¶ bilibili_search äº‹ä»¶            â”‚
              â”œâ”€ 6. å¹¿æ’­ bilibili_search_command          â”‚
              â”‚                                           â†“
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  æ²¹çŒ´æ’ä»¶ (all.js)
                                                          â”‚
                                                          â”œâ”€ 7. å¤„ç†æœç´¢å‘½ä»¤
                                                          â”œâ”€ 8. æ„å»ºæœç´¢URL
                                                          â””â”€ 9. è·³è½¬åˆ°æœç´¢ç»“æœé¡µ
```

## ä¿®æ”¹æ–‡ä»¶æ¸…å•

### 1. **æ²¹çŒ´æ’ä»¶ (all.js)**
- âœ… æ·»åŠ  `@match https://www.bilibili.com/*`
- âœ… æ›´æ–° `isTargetWebsite` æ­£åˆ™è¡¨è¾¾å¼åŒ…å« bilibili.com
- âœ… æ·»åŠ  `handleBilibiliSearch(keyword)` å‡½æ•°
- âœ… æ·»åŠ  `socket.on('bilibili_search_command')` ç›‘å¬å™¨
- âœ… æœç´¢è·³è½¬ä½¿ç”¨ `window.location.href`ï¼ˆå½“å‰é¡µé¢ï¼‰

### 2. **Server ç«¯ (main.py)**
- âœ… æ·»åŠ  `@socketio.on('bilibili_search')` äº‹ä»¶å¤„ç†
- âœ… éªŒè¯æœç´¢å…³é”®è¯éç©º
- âœ… å¹¿æ’­ `bilibili_search_command` ç»™æ²¹çŒ´æ’ä»¶
- âœ… è¿”å› `bilibili_search_response` ç»™å‰ç«¯

### 3. **å‰ç«¯ HTML (index.html)**
- âœ… æ·»åŠ  `bilibili-search-container` å®¹å™¨ï¼ˆé»˜è®¤éšè—ï¼‰
- âœ… æ·»åŠ æœç´¢è¾“å…¥æ¡† `bilibili-search-input`
- âœ… æ·»åŠ æœç´¢æŒ‰é’® `bilibili-search-btn`ï¼ˆå¸¦å›¾æ ‡ï¼‰

### 4. **å‰ç«¯ CSS (styles.css)**
- âœ… æ·»åŠ  `.bilibili-search-container` æ ·å¼
- âœ… æ·»åŠ  `.search-input-group` Flex å¸ƒå±€
- âœ… æ·»åŠ  `.bilibili-search-input` è¾“å…¥æ¡†æ ·å¼ï¼ˆç²‰è‰²èšç„¦æ•ˆæœï¼‰
- âœ… æ·»åŠ  `.bilibili-search-btn` æŒ‰é’®æ ·å¼ï¼ˆBç«™ç²‰è‰²ä¸»é¢˜ï¼‰
- âœ… æ·»åŠ  hoverã€activeã€disabled çŠ¶æ€æ ·å¼

### 5. **å‰ç«¯ JS (script.js)**
- âœ… è·å–æœç´¢ç›¸å…³ DOM å…ƒç´ 
- âœ… ä¿®æ”¹ `bilibiliModeToggle` äº‹ä»¶ï¼šå¼€å¯æ—¶æ˜¾ç¤ºæœç´¢æ¡†
- âœ… æ·»åŠ  `bilibiliSearchBtn` ç‚¹å‡»äº‹ä»¶ï¼šå‘é€ WebSocket æ¶ˆæ¯
- âœ… æ·»åŠ æœç´¢æ¡†å›è½¦é”®æ”¯æŒ
- âœ… ä¿®æ”¹ `enableButtons` å‡½æ•°ï¼šæ§åˆ¶æœç´¢æ¡†å¯ç”¨/ç¦ç”¨
- âœ… æ·»åŠ  `socket.on('bilibili_search_response')` å¤„ç†

## ä½¿ç”¨æ­¥éª¤

### å‡†å¤‡å·¥ä½œ
1. å¯åŠ¨ Server
   ```bash
   cd /Users/ken/Desktop/apptv
   python3 main.py
   ```

2. macOS æµè§ˆå™¨å®‰è£…æ²¹çŒ´æ’ä»¶å¹¶è®¿é—® bilibili.com

3. æ‰‹æœºæ‰«æäºŒç»´ç æ‰“å¼€é¥æ§å™¨ç•Œé¢ `http://192.168.1.16:5003`

### æœç´¢æµç¨‹
1. **æ‰“å¼€Bç«™æ¨¡å¼**
   - åœ¨é¥æ§å™¨ç•Œé¢æ‰¾åˆ°"Bç«™æ¨¡å¼"å¼€å…³
   - ç‚¹å‡»å¼€å…³ï¼Œå¼€å¯Bç«™æ¨¡å¼

2. **è¾“å…¥æœç´¢å…³é”®è¯**
   - å¼€å…³ä¸‹æ–¹ä¼šè‡ªåŠ¨æ˜¾ç¤ºæœç´¢è¾“å…¥æ¡†
   - è¾“å…¥æƒ³è¦æœç´¢çš„å…³é”®è¯ï¼ˆä¾‹å¦‚ï¼š"ç¼–ç¨‹æ•™ç¨‹"ï¼‰

3. **æ‰§è¡Œæœç´¢**
   - ç‚¹å‡»"æœç´¢"æŒ‰é’®ï¼ˆæˆ–æŒ‰å›è½¦é”®ï¼‰
   - macOS æµè§ˆå™¨ä¼šè‡ªåŠ¨è·³è½¬åˆ° B ç«™æœç´¢ç»“æœé¡µ
   - URL æ ¼å¼ï¼š`https://search.bilibili.com/all?keyword=ç¼–ç¨‹æ•™ç¨‹`

4. **å…³é—­Bç«™æ¨¡å¼**
   - å†æ¬¡ç‚¹å‡»å¼€å…³ï¼Œæœç´¢æ¡†è‡ªåŠ¨éšè—

## æµ‹è¯•åœºæ™¯

### âœ… æ­£å¸¸æµç¨‹
- [ ] æ‰“å¼€Bç«™æ¨¡å¼ â†’ æœç´¢æ¡†æ˜¾ç¤º
- [ ] è¾“å…¥å…³é”®è¯ â†’ æœç´¢æ¡†å¯æ­£å¸¸è¾“å…¥
- [ ] ç‚¹å‡»æœç´¢ â†’ macOSæµè§ˆå™¨è·³è½¬åˆ°æœç´¢ç»“æœ
- [ ] å…³é—­Bç«™æ¨¡å¼ â†’ æœç´¢æ¡†éšè—

### âœ… è¾¹ç•Œæƒ…å†µ
- [ ] ç©ºå…³é”®è¯æœç´¢ â†’ æç¤º"è¯·è¾“å…¥æœç´¢å…³é”®è¯"
- [ ] WebSocket æœªè¿æ¥ â†’ æç¤º"WebSocketæœªè¿æ¥"
- [ ] æœç´¢æ¡†å›è½¦é”® â†’ ç­‰åŒäºç‚¹å‡»æœç´¢æŒ‰é’®

### âœ… è¿æ¥çŠ¶æ€
- [ ] æ–­å¼€è¿æ¥ â†’ æœç´¢æ¡†å’ŒæŒ‰é’®ç¦ç”¨
- [ ] é‡æ–°è¿æ¥ â†’ æœç´¢æ¡†å’ŒæŒ‰é’®å¯ç”¨

## WebSocket äº‹ä»¶æ¥å£

### å‰ç«¯ â†’ Server
```javascript
socket.emit('bilibili_search', {
  keyword: 'æœç´¢å…³é”®è¯'
});
```

### Server â†’ æ²¹çŒ´æ’ä»¶
```javascript
socketio.emit('bilibili_search_command', {
  keyword: 'æœç´¢å…³é”®è¯',
  timestamp: 1234567890
});
```

### Server â†’ å‰ç«¯
```javascript
emit('bilibili_search_response', {
  success: true,
  keyword: 'æœç´¢å…³é”®è¯',
  message: 'Bç«™æœç´¢å‘½ä»¤å·²å‘é€'
});
```

## UI æ•ˆæœ

### Bç«™æ¨¡å¼å…³é—­æ—¶
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bç«™æ¨¡å¼  [â—‹â”€â”€â”€â”€]  OFF  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Bç«™æ¨¡å¼å¼€å¯æ—¶
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bç«™æ¨¡å¼  [â”€â”€â”€â”€â—]  ON   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ è¾“å…¥æ¡†... â”‚  ğŸ” æœç´¢ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å…³é”®ä»£ç ç‰‡æ®µ

### æ²¹çŒ´æ’ä»¶æœç´¢å¤„ç†
```javascript
function handleBilibiliSearch(keyword) {
  const searchUrl = `https://search.bilibili.com/all?keyword=${encodeURIComponent(keyword.trim())}`;
  window.location.href = searchUrl;  // å½“å‰é¡µé¢è·³è½¬
}
```

### Server äº‹ä»¶å¤„ç†
```python
@socketio.on('bilibili_search')
def handle_bilibili_search(data):
    keyword = data.get('keyword', '').strip()
    socketio.emit('bilibili_search_command', {
        "keyword": keyword,
        "timestamp": int(time.time())
    })
```

### å‰ç«¯å‘é€æœç´¢
```javascript
socket.emit('bilibili_search', { keyword: keyword });
```

## æ³¨æ„äº‹é¡¹

1. âš ï¸ macOS æµè§ˆå™¨å¿…é¡»å·²è®¿é—® bilibili.comï¼ˆæ²¹çŒ´æ’ä»¶æ‰èƒ½ç”Ÿæ•ˆï¼‰
2. âš ï¸ æœç´¢ä¼šåœ¨å½“å‰æ ‡ç­¾é¡µè·³è½¬ï¼Œä¸ä¼šæ‰“å¼€æ–°æ ‡ç­¾
3. âš ï¸ å…³é”®è¯ä¼šè‡ªåŠ¨ URL ç¼–ç ï¼Œæ”¯æŒä¸­æ–‡æœç´¢
4. âš ï¸ Bç«™æ¨¡å¼å¿…é¡»å¼€å¯æ‰èƒ½çœ‹åˆ°æœç´¢æ¡†

## ä¼˜åŠ¿ç‰¹æ€§

- ğŸ¨ UI é‡‡ç”¨ B ç«™ç²‰è‰²ä¸»é¢˜ (#fb7299)
- âŒ¨ï¸ æ”¯æŒå›è½¦é”®å¿«é€Ÿæœç´¢
- ğŸ”’ è¿æ¥æ–­å¼€æ—¶è‡ªåŠ¨ç¦ç”¨æœç´¢åŠŸèƒ½
- âœ¨ æœç´¢æˆåŠŸåè‡ªåŠ¨æ¸…ç©ºè¾“å…¥æ¡†
- ğŸ“± å“åº”å¼è®¾è®¡ï¼Œé€‚é…æ‰‹æœºå±å¹•
